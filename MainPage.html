<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>公会大厅</title>
      <link rel="stylesheet" href="./style.css">
    <style>
       .information{
           text-align: left;
       }
       h3{
            font-size: clamp(10px,4vw,20px);
            font-weight: 800;
             color: rgba(100,100,100,0.8);
           margin: 1vh;
       }

.card:hover {
     box-shadow: 0 6px 20px rgba(255, 192, 203, 0.6);
     transform: translateY(-5px);
}
.selfInfo{
    margin-top:0;
    color:rgba(255,255,255,0.8);
    font-weight: 600;
    font-size: clamp(10px,4vw,20px);
}
.skill{
    background: linear-gradient(50deg, rgba(255,255,255,0.5),rgba(200,80,80,0.5));
    border-radius: 5px;
    transition: 0.5s;
}
.skill:hover{
    background: linear-gradient(135deg, white,rgba(200,80,80,0.5));
    transform: scale(1.05);
}
.welcomeBox{
    position: fixed;
    top: 5%;
    left: 50%;
    text-align: center;
    transform: translate(-50%);
    padding: 2vh 10vw 2vh 10vw;
    border-radius: 50px;
    color: white;
    opacity: 0;
    pointer-events: none;
    background: rgba(10,10,10,0.6);
    transition: opacity 0.8s, top 0.8s;
    font-size: clamp(10px,4vw,20px);
    z-index: 9999;
}
.welcomeBox.show{
    opacity: 1;
    top: 10%;
}
</style>


</head>
<body>
<div id = "HeadLine"></div>
<div class="welcomeBox" id="welcome"></div>
<!--<img src="Headimg.png" alt="加载不出了喵" class="full-width">-->
<br>

<div class="card-container">
    <div class="card information">
        <div class="selfInfo">喵险者信息<hr class="cardLine"></div>
<h3>喵险者: <span id="hello"></span></h3> <img style="border-radius: 15px;position: fixed;right: 5px;top: 5px;max-width: clamp(50px,20vw,100px);border:white solid 3px" alt= "图炸了喵" src="./img/userhead.jpg">
        <h3>你的鱼干: <span id="fish"></span> 个</h3>
        <h3>喵险者等级: <span id="level"></span></h3>
        <h3>——Adventurer's Guild——</h3>
        <h3>EXP: </h3><div><canvas style="margin-left:8px;width:90%;height: 20px" id="canvas"></canvas></div>
        <h3>Skill: <span class="skill">吃鱼</span></h3>
    </div>
    <div class="card">
        <p>冒险小工具</p>
        <div class="button-container">
            <a href="BMICalculator.html"><button class="MainBotton">BMI计算器</button></a>
            <a href="calculator.html"><button class="MainBotton">普通计算器(测试版)</button></a>
            <a href="future.html"><button class="MainBotton">占卜</button></a>
        </div>
    </div>

    <div class="card">
        <p>鱼干任务板</p>
        <div class="button-container">
            <a href="Snake.html"><button class="MainBotton">贪吃蛇</button></a>
            <a href="cat.html"><button class="MainBotton">猫咪赛跑</button></a>
            <a href="new_bird.html"><button class="MainBotton">小鸟游戏(新)</button></a>
            <a href="pet.html"><button class="MainBotton">喵险随从</button></a>
        </div>
    </div>
</div>

</body>
<script src="fish.js"></script>
<script src="HeadLine.js"></script>
<script>
    addEventListener("load",loadHeadLine)
    addEventListener("load", hello)
     async function hello(){
         await loadFish()
         document.getElementById('hello').textContent = `${playerName}`;
         level()
     }

     function level(){
        const playerFish = Number(document.getElementById("fish").textContent);
        const levelEXP = [10000,30000,100000,200000,1000000,2000000]
         let user_lv = null;
        switch(true){
            case (playerFish<=levelEXP[0]):user_lv = "白瓷"
                break
            case (playerFish<=levelEXP[1]):user_lv = "铁"
                break
            case (playerFish<=levelEXP[2]):user_lv = "银"
                break
            case (playerFish<=levelEXP[3]):user_lv = "金"
                break
            case (playerFish<=levelEXP[4]):user_lv = "黄金"
                break
            case (playerFish<=levelEXP[5]):user_lv = "秘银"
                break
            default:user_lv = "精钢"
        }
        document.getElementById("level").textContent = user_lv
        drawEXP(levelEXP,playerFish,user_lv)
         const text = `这不是${user_lv}级喵险者的${playerName}吗？欢迎来到公会`;
         welcome(text,1500)
     }
     function drawEXP(levelEXP,playerFish,user_lv){
          const canvas = document.getElementById("canvas");
          const ctx = canvas.getContext("2d");
          let EXP = 0
          canvas.width = canvas.offsetWidth;
          canvas.height = canvas.offsetHeight
          ctx.fillStyle = "white";
          ctx.fillRect(0, 0, canvas.width, canvas.height);
          switch (user_lv){
              case "白瓷":EXP = playerFish/levelEXP[0]*canvas.width
                  break;
              case "铁":EXP = (playerFish-levelEXP[0])/levelEXP[1]*canvas.width
                  break;
              case "银":EXP = (playerFish-levelEXP[1])/levelEXP[2]*canvas.width
                  break;
              case "金":EXP = (playerFish-levelEXP[2])/levelEXP[3]*canvas.width
                  break;
              case "黄金":EXP = (playerFish-levelEXP[3])/levelEXP[4]*canvas.width
                  break;
              case "秘银":EXP = (playerFish-levelEXP[4])/levelEXP[5]*canvas.width
                  break;
              default: EXP = canvas.width
          }
          ctx.fillStyle = "#ff6f91";
          ctx.fillRect(0, 0, EXP, canvas.height);
      }
      function welcome(text,time){
        document.getElementById("welcome").textContent = text;
         const justLoggedIn = sessionStorage.getItem("justLoggedIn");
         if (justLoggedIn === "true") {
      document.getElementById("welcome").classList.add("show");
      sessionStorage.setItem("justLoggedIn", "false")
      setTimeout(() => {
          document.getElementById("welcome").classList.remove("show");
      }, time)
      }
      }

</script>

</html>
